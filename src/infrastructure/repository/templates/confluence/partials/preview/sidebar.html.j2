{# Sidebar Navigation (Page Tree) #}
<nav class="confluence-sidebar">
    <div class="space-info">
        <div class="space-name">{{ api.info.title }}</div>
        <div class="space-key">{{ space_key }}</div>
    </div>

    <ul class="page-tree">
        <!-- Root Page -->
        <li class="page-tree-item">
            <a href="#overview" class="page-tree-link active" onclick="showPage('overview')">
                <span class="page-icon">ğŸ“„</span>
                <span>Overview</span>
            </a>
        </li>

        <!-- Endpoints by Tag -->
        {% if api.tags %}
        <li class="page-tree-item">
            <a href="#" class="page-tree-link">
                <span class="page-icon">ğŸ“</span>
                <span>Endpoints</span>
            </a>
            <ul class="page-tree-children">
                {% for tag in api.tags %}
                <li class="page-tree-item">
                    <a href="javascript:void(0)" class="page-tree-link tag-folder" onclick="toggleFolder('folder-{{ tag.name }}')">
                        <span class="page-icon">ğŸ“</span>
                        <span>{{ tag.name }}</span>
                        <span class="folder-arrow">â–¶</span>
                    </a>
                    <ul id="folder-{{ tag.name }}" class="page-tree-children" style="display:none;">
                        {% for path, path_item in api.paths.items() %}
                            {% for method, operation in path_item.operations.items() %}
                                {% if tag.name in operation.tags %}
                                {% set endpoint_id = (tag.name + '-' + method + '-' + path)|replace('/', '-')|replace('{', '')|replace('}', '') %}
                                <li class="page-tree-item">
                                    <a href="#endpoint-{{ endpoint_id }}" class="page-tree-link" onclick="showPage('endpoint-{{ endpoint_id }}')">
                                        <span class="http-method-icon method-{{ method.lower() }}">{{ method[:1] }}</span>
                                        <span class="endpoint-path">{{ method.upper() }} {{ path }}</span>
                                    </a>
                                </li>
                                {% endif %}
                            {% endfor %}
                        {% endfor %}
                    </ul>
                </li>
                {% endfor %}
            </ul>
        </li>
        {% endif %}

        <!-- Schemas -->
        {% if api.components.schemas %}
        <li class="page-tree-item">
            <a href="#schemas" class="page-tree-link" onclick="showPage('schemas')">
                <span class="page-icon">ğŸ“Š</span>
                <span>Data Models</span>
            </a>
        </li>
        {% endif %}

        <!-- Security -->
        {% if api.components.security_schemes %}
        <li class="page-tree-item">
            <a href="#security" class="page-tree-link" onclick="showPage('security')">
                <span class="page-icon">ğŸ”</span>
                <span>Security</span>
            </a>
        </li>
        {% endif %}
    </ul>
</nav>

